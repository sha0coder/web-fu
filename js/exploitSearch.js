/* 
	Looking for exploits
	@sha0coder
*/


(function() {

	exploitDB = {
		//url: 'http://www.exploit-db.com/search/?action=search&filter_page=1&description=&exploit_text=##&author=&platform=0&type=0&p_language=0&port=&osvdb=&cve=&=&',
		url: 'http://www.exploit-db.com/search/?action=search&filter_page=1&filter_description=&filter_exploit_text=##&filter_author=&filter_platform=0&filter_type=0&filter_lang_id=0&filter_port=&filter_osvdb=&filter_cve=',
		post: null
	};

	day1337 = {
		url: 'http://www.1337day.com/search',
		post: 'dong=##&submit_search=Search&'
	};

	exploitSearch = {
		url: 'http://exploitsearch.com/search.html?cx=000255850439926950150:_vswux9nmz0&cof=FORID:10&q=##&sa=Search&',
		post: null
	};

	packetStorm = {
		url: 'http://packetstormsecurity.com/search/?q=##&=&s-files=files&s-news=news&s-users=users&s-authors=authors&',
		post: null
	};

	metasploit = {
		url: 'http://www.rapid7.com/db/search?utf8=%E2%9C%93&q=##&t=m',
		post: null
	};

	cveDetails = {
		url: 'http://www.cvedetails.com/vulnerability-search.php?f=1&vendor=&product=##&cveid=&cweid=&hasexp=1&cvssscoremin=&cvssscoremax=&psy=&psm=&pey=&pem=&usy=&usm=&uey=&uem=&opbyp=1&opxss=1&opdos=1&opdirt=1&opec=1&opgpriv=1&ophttprs=1&opmemc=1&opginf=1&opov=1&opcsrf=1&opfileinc=1&opsqli=1&av_1=1&av_2=1&av_3=1&ac_1=1&ac_2=1&ac_3=1&au_1=1&au_2=1&au_3=1&co_1=1&co_2=1&co_3=1&intg_1=1&intg_2=1&intg_3=1&av_1=1&av_2=1&av_3=1&sp_0=1&sp_1=1&sp_2=1&sp_3=1&=Search&',
		post: null
	};

	xpltSearch = {
		engines: [
			exploitDB, 
			exploitSearch,
			metasploit
		],

		post: {
			frm: null,
			data: null
		}
	};

	xpltSearch.doPost = function(url,data) {
		window.open(url,'exploitSearchWindow');
		xpltSearch.post.data = data;
		xpltSearch.post.frm.submit(url);
	};

	xpltSearch.doGet = function(url) {
		window.open(url);
	};

	xpltSearch.init = function() {
		//post form
		xpltSearch.post.frm = o('doPost').getObj();
		xpltSearch.post.data = o('postData');

		//button event
		o('btnExploitSearch').click(function() {
			xpltSearch.onExploitSearch(o('txtExploitSearch').get())
		});
	};

	xpltSearch.onExploitSearch = function(keywords) {

		xpltSearch.engines.forEach(function(eng) {

			if (eng.post) 
				xpltSearch.doPost(eng.url.replace('##',keywords), eng.post.replace('##',keywords));

			else
				xpltSearch.doGet(eng.url.replace('##',keywords));

		});

	};

})();


xpltSearch.init();